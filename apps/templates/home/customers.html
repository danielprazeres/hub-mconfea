{% extends "layouts/base.html" %}

{% block title %} Cadastro de Clientes {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

  <div class="content">
    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
            <h5 class="title">Cadastro de Cliente</h5>
          </div>

          <div class="card-body">
            {% if msg %}
            <div class="alert alert-{{ 'success' if 'sucesso' in msg else 'danger' }}">
              {{ msg | safe }}
            </div>
            {% endif %}
            
            <form method="post" action="">
              {{ form.hidden_tag() }}

              <!-- Identifica√ß√£o Fiscal -->
              <h6 class="heading-small text-muted mb-4">üßæ Identifica√ß√£o Fiscal</h6>
              <div class="row">
                <div class="col-md-6 pr-md-1">
                  <div class="form-group">
                    <label>Nome/Raz√£o Social *</label>
                    <input type="text" class="form-control" name="nome_razao_social" required>
                  </div>
                </div>
                <div class="col-md-3 pr-md-1">
                  <div class="form-group">
                    <label>NIF *</label>
                    <input type="text" class="form-control" name="nif" required>
                  </div>
                </div>
                <div class="col-md-3 pl-md-1">
                  <div class="form-group">
                    <label>Tipo de Cliente *</label>
                    <select class="form-control" name="tipo_cliente" required>
                      <option value="singular">Pessoa Singular</option>
                      <option value="coletiva">Pessoa Coletiva</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Morada de Fatura√ß√£o -->
              <h6 class="heading-small text-muted mb-4 mt-4">üì¨ Morada de Fatura√ß√£o</h6>
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <label>Morada</label>
                    <input type="text" class="form-control" name="morada" placeholder="Endere√ßo completo">
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-4 pr-md-1">
                  <div class="form-group">
                    <label>Rua</label>
                    <input type="text" class="form-control" name="rua">
                  </div>
                </div>
                <div class="col-md-2 px-md-1">
                  <div class="form-group">
                    <label>N√∫mero</label>
                    <input type="text" class="form-control" name="numero">
                  </div>
                </div>
                <div class="col-md-2 px-md-1">
                  <div class="form-group">
                    <label>Lote</label>
                    <input type="text" class="form-control" name="lote">
                  </div>
                </div>
                <div class="col-md-4 pl-md-1">
                  <div class="form-group">
                    <label>Complemento</label>
                    <input type="text" class="form-control" name="complemento">
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-3 pr-md-1">
                  <div class="form-group">
                    <label>C√≥digo Postal</label>
                    <input type="text" class="form-control" name="codigo_postal">
                  </div>
                </div>
                <div class="col-md-3 px-md-1">
                  <div class="form-group">
                    <label>Cidade</label>
                    <input type="text" class="form-control" name="cidade">
                  </div>
                </div>
                <div class="col-md-3 px-md-1">
                  <div class="form-group">
                    <label>Distrito</label>
                    <input type="text" class="form-control" name="distrito">
                  </div>
                </div>
                <div class="col-md-3 pl-md-1">
                  <div class="form-group">
                    <label>Localidade</label>
                    <input type="text" class="form-control" name="localidade">
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <label>Pa√≠s</label>
                    <input type="text" class="form-control" name="pais" value="Portugal">
                  </div>
                </div>
              </div>

              <!-- Contato -->
              <h6 class="heading-small text-muted mb-4 mt-4">üìû Informa√ß√µes de Contato</h6>
              <div class="row">
                <div class="col-md-4 pr-md-1">
                  <div class="form-group">
                    <label>Telefone</label>
                    <input type="text" class="form-control" name="telefone">
                  </div>
                </div>
                <div class="col-md-4 px-md-1">
                  <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" name="email">
                  </div>
                </div>
                <div class="col-md-4 pl-md-1">
                  <div class="form-group">
                    <label>Pessoa de Contato</label>
                    <input type="text" class="form-control" name="pessoa_contato">
                  </div>
                </div>
              </div>

              <!-- Dados Empresariais (apenas para Pessoa Coletiva) -->
              <div id="dados_empresariais" style="display: none;">
                <h6 class="heading-small text-muted mb-4 mt-4">üè¢ Dados Empresariais</h6>
                <div class="row">
                  <div class="col-md-4 pr-md-1">
                    <div class="form-group">
                      <label>Raz√£o Social</label>
                      <input type="text" class="form-control" name="razao_social">
                    </div>
                  </div>
                  <div class="col-md-4 px-md-1">
                    <div class="form-group">
                      <label>CAE</label>
                      <input type="text" class="form-control" name="cae">
                    </div>
                  </div>
                  <div class="col-md-4 pl-md-1">
                    <div class="form-group">
                      <label>NIPC</label>
                      <input type="text" class="form-control" name="nipc">
                    </div>
                  </div>
                </div>
              </div>

              <!-- Faturamento/Pagamento -->
              <h6 class="heading-small text-muted mb-4 mt-4">üí≥ Faturamento / Pagamento</h6>
              <div class="row">
                <div class="col-md-4 pr-md-1">
                  <div class="form-group">
                    <label>IBAN</label>
                    <input type="text" class="form-control" name="iban">
                  </div>
                </div>
                <div class="col-md-4 px-md-1">
                  <div class="form-group">
                    <label>M√©todo de Pagamento</label>
                    <select class="form-control" name="metodo_pagamento">
                      <option value="transferencia">Transfer√™ncia Banc√°ria</option>
                      <option value="cartao">Cart√£o</option>
                      <option value="dinheiro">Dinheiro</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-4 pl-md-1">
                  <div class="form-group">
                    <label>Condi√ß√µes de Pagamento</label>
                    <select class="form-control" name="condicoes_pagamento">
                      <option value="imediato">Imediato</option>
                      <option value="30dias">30 Dias</option>
                      <option value="60dias">60 Dias</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Observa√ß√µes -->
              <h6 class="heading-small text-muted mb-4 mt-4">üìù Observa√ß√µes</h6>
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <textarea class="form-control" name="observacoes" rows="3" placeholder="Observa√ß√µes adicionais sobre o cliente..."></textarea>
                  </div>
                </div>
              </div>

              <div class="row mt-4">
                <div class="col-md-12">
                  <button type="submit" class="btn btn-primary">Salvar Cliente</button>
                  <a href="{{ url_for('authentication_blueprint.customers_list') }}" class="btn btn-secondary">Voltar para Lista</a>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

{% endblock content %}

{% block javascripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const tipoClienteSelect = document.querySelector('select[name="tipo_cliente"]');
    const dadosEmpresariaisDiv = document.getElementById('dados_empresariais');
    
    function toggleDadosEmpresariais() {
        if (tipoClienteSelect.value === 'coletiva') {
            dadosEmpresariaisDiv.style.display = 'block';
        } else {
            dadosEmpresariaisDiv.style.display = 'none';
        }
    }
    
    tipoClienteSelect.addEventListener('change', toggleDadosEmpresariais);
    toggleDadosEmpresariais(); // Execute on page load
});
</script>
{% endblock javascripts %} 